<!DOCTYPE html>
<html lang="{{ request.locale.iso_code }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="preconnect" href="https://cdn.shopify.com">
  
  <style>
    /* ==================== */
    /* BASE VARIABLES */
    /* ==================== */
    :root {
      --header-height: 70px;
      --primary-color: #E8C4B8;
      --text-dark: #2D2D2D;
      --white: #FFFFFF;
      --sidebar-width: 280px;
    }

    /* ==================== */
    /* BASIC RESET */
    /* ==================== */
    body {
      margin: 0;
      padding-top: var(--header-height);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      overflow-x: hidden;
    }

    /* ==================== */
    /* DESKTOP SIDEBAR ONLY (1025px and up) */
    /* ==================== */
    @media (min-width: 1025px) {
      .desktop-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: var(--sidebar-width);
        height: 100vh;
        background: var(--white);
        z-index: 1000;
        border-right: 1px solid rgba(0, 0, 0, 0.08);
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
      }
      
      body {
        margin-left: var(--sidebar-width);
        padding-top: 0 !important;
      }
      
      .mobile-header {
        display: none !important;
      }
      
      .mobile-sidebar,
      .mobile-sidebar-overlay {
        display: none !important;
      }
    }

    /* ==================== */
    /* MOBILE/TABLET HEADER (1024px and below) */
    /* ==================== */
    @media (max-width: 1024px) {
      .desktop-sidebar {
        display: none !important;
      }
      
      body {
        margin-left: 0 !important;
        padding-top: var(--header-height) !important;
      }
      
      /* Mobile Header - SIMPLE & WORKING */
      .mobile-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: var(--header-height);
        background: var(--white);
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        z-index: 1000;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      .header-container {
        max-width: 100%;
        margin: 0 auto;
        padding: 0 20px;
        height: 100%;
      }

      .header-inner {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 100%;
        position: relative;
      }

      /* Logo */
      .logo {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
      }

      .logo img {
        height: 35px;
        width: auto;
        max-width: 120px;
        object-fit: contain;
      }

      /* Hamburger Menu Button - VISIBLE */
      .sidebar-toggle {
        background: none;
        border: none;
        width: 44px;
        height: 44px;
        display: flex !important;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        color: var(--text-dark);
        padding: 0;
        z-index: 1002;
        visibility: visible !important;
        opacity: 1 !important;
      }

      /* Header Actions */
      .header-actions {
        display: flex;
        align-items: center;
        gap: 16px;
        z-index: 1002;
      }

      .header-action {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 44px;
        height: 44px;
        text-decoration: none;
        color: var(--text-dark);
        position: relative;
      }

      .cart-count {
        background: var(--primary-color);
        color: var(--white);
        border-radius: 50%;
        width: 18px;
        height: 18px;
        font-size: 11px;
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        top: -2px;
        right: -2px;
      }
      
      /* Mobile Sidebar - SIMPLE & WORKING */
      .mobile-sidebar {
        position: fixed;
        top: 0;
        left: -100%;
        width: 85%;
        max-width: 320px;
        height: 100vh;
        background: var(--white);
        z-index: 9999;
        transition: left 0.3s ease;
        overflow-y: auto;
        box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
        visibility: visible !important;
      }

      .mobile-sidebar.active {
        left: 0;
      }

      /* Mobile Sidebar Overlay */
      .mobile-sidebar-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 9998;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .mobile-sidebar-overlay.active {
        opacity: 1;
        visibility: visible;
      }
      
      /* Body lock when sidebar is open */
      body.mobile-sidebar-open {
        overflow: hidden;
      }
    }

    /* ==================== */
    /* COMMON SIDEBAR STYLES */
    /* ==================== */
    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.08);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .sidebar-logo img {
      height: 35px;
      width: auto;
      max-width: 140px;
    }

    .sidebar-close {
      background: none;
      border: none;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 24px;
      color: var(--text-dark);
      padding: 0;
    }

    .sidebar-content {
      padding: 20px 0;
      overflow-y: auto;
      height: calc(100vh - 140px);
    }

    .sidebar-section {
      margin-bottom: 20px;
    }

    .sidebar-section-title {
      padding: 0 20px 10px;
      font-size: 13px;
      font-weight: 600;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .sidebar-menu {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar-menu-item {
      margin: 0;
      position: relative;
    }

    .sidebar-menu-link {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 20px;
      text-decoration: none;
      color: var(--text-dark);
      font-size: 15px;
      font-weight: 500;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
      cursor: pointer;
      width: 100%;
      text-align: left;
      background: none;
      font-family: inherit;
    }

    .sidebar-menu-link:hover,
    .sidebar-menu-link.active {
      background: rgba(232, 196, 184, 0.1);
      color: var(--primary-color);
      border-left-color: var(--primary-color);
    }

    .sidebar-menu-count {
      font-size: 12px;
      color: #666;
      background: rgba(0, 0, 0, 0.05);
      padding: 2px 8px;
      border-radius: 10px;
    }

    /* All Products Icon */
    .all-products-icon {
      margin-right: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 20px;
      height: 20px;
    }

    /* Categories Dropdown */
    .categories-dropdown {
      background: rgba(0, 0, 0, 0.02);
      border-left: 4px solid rgba(232, 196, 184, 0.3);
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .categories-dropdown.active {
      max-height: 500px;
    }

    .categories-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      padding: 15px 0;
      gap: 20px;
    }

    .category-column {
      padding: 0 20px;
    }

    .category-column-title {
      font-size: 13px;
      font-weight: 600;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin: 0 0 12px 0;
      padding-bottom: 6px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }

    .category-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .category-item {
      margin-bottom: 8px;
    }

    .category-link {
      display: block;
      padding: 8px 0;
      text-decoration: none;
      color: #444;
      font-size: 14px;
      transition: all 0.3s ease;
      position: relative;
      padding-left: 20px;
      font-weight: 500;
    }

    .category-link:hover {
      color: var(--primary-color);
      transform: translateX(5px);
    }

    .category-link::before {
      content: "";
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 6px;
      height: 6px;
      background: var(--primary-color);
      border-radius: 50%;
      opacity: 0.6;
    }

    .category-link:hover::before {
      opacity: 1;
      background: var(--primary-color);
    }

    .no-products-message {
      padding: 15px 20px;
      color: #888;
      font-size: 14px;
      font-style: italic;
    }

    /* Sidebar Footer */
    .sidebar-footer {
      padding: 20px;
      border-top: 1px solid rgba(0, 0, 0, 0.08);
    }

    .sidebar-account {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      text-decoration: none;
      color: var(--text-dark);
      border-radius: 8px;
      transition: all 0.3s ease;
      background: rgba(0, 0, 0, 0.02);
    }
    
    /* Desktop hover effects */
    @media (min-width: 1025px) {
      .sidebar-menu-item.has-dropdown:hover .categories-dropdown {
        max-height: 500px;
      }
    }
    
    /* Mobile submenu arrow */
    .mobile-arrow {
      transition: transform 0.3s ease;
      margin-left: 8px;
    }
    
    .sidebar-menu-item.active .mobile-arrow {
      transform: rotate(90deg);
    }
    
    /* Product count badge */
    .product-count {
      font-size: 11px;
      color: #888;
      background: rgba(0, 0, 0, 0.05);
      padding: 2px 6px;
      border-radius: 8px;
      margin-left: 8px;
    }
  </style>
</head>
<body>
  <!-- DESKTOP SIDEBAR (Visible only on desktop) -->
  <aside class="desktop-sidebar">
    <div class="sidebar-header">
      <a href="{{ routes.root_url }}" class="sidebar-logo">
        <img 
          src="https://cdn.shopify.com/s/files/1/0567/4172/4316/files/logo.jpg?v=1764436849" 
          alt="{{ shop.name }}"
          width="140"
          height="35"
          loading="eager"
        >
      </a>
    </div>

    <div class="sidebar-content">
      <nav class="sidebar-nav">
        <!-- Shop Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Shop</div>
          <ul class="sidebar-menu">
            <!-- Single "All Products" with Categories Dropdown -->
            <li class="sidebar-menu-item has-dropdown">
              <button class="sidebar-menu-link all-products-btn">
                <span style="display: flex; align-items: center;">
                  <span class="all-products-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M10 3H4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1zm10 0h-6a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1zM10 13H4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1zm10 0h-6a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1z"/>
                    </svg>
                  </span>
                  All Products
                </span>
                <span class="sidebar-menu-count">{{ collections.all.products_count | default: 0 }}</span>
              </button>
              
              <!-- Categories Dropdown -->
              <div class="categories-dropdown">
                <div class="categories-grid">
                  <!-- Product Type Column -->
                  <div class="category-column">
                    <div class="category-column-title">Shop by Category</div>
                    <ul class="category-list">
                      <!-- Get all collections (or featured collections) -->
                      {% assign main_collections = collections %}
                      
                      {% if main_collections.size > 0 %}
                        {% for collection in main_collections limit: 8 %}
                          {% unless collection.handle == 'all' or collection.handle == 'frontpage' %}
                            <li class="category-item">
                              <a href="{{ collection.url }}" class="category-link">
                                {{ collection.title }}
                                {% if collection.products_count > 0 %}
                                  <span class="product-count">{{ collection.products_count }}</span>
                                {% endif %}
                              </a>
                            </li>
                          {% endunless %}
                        {% endfor %}
                      {% else %}
                        <!-- Fallback: Show hardcoded product categories -->
                        {% assign product_categories = "Shampoos,Conditioners,Curl Creams,Hair Oils,Styling Products,Hair Treatments,Accessories,Travel Kits" | split: ',' %}
                        {% for category in product_categories %}
                          <li class="category-item">
                            <a href="{{ routes.collections_url }}" class="category-link">
                              {{ category }}
                            </a>
                          </li>
                        {% endfor %}
                      {% endif %}
                      
                      <!-- View All Collections Link -->
                      <li class="category-item">
                        <a href="{{ routes.collections_url }}" class="category-link" style="font-weight: 600; color: var(--primary-color);">
                          View All Collections â†’
                        </a>
                      </li>
                    </ul>
                  </div>
                  
                  <!-- Featured/Best Sellers Column -->
                  <div class="category-column">
                    <div class="category-column-title">Popular Products</div>
                    <ul class="category-list">
                      <!-- Get featured products -->
                      {% assign featured_products = collections.all.products | limit: 6 %}
                      
                      {% if featured_products.size > 0 %}
                        {% for product in featured_products %}
                          <li class="category-item">
                            <a href="{{ product.url }}" class="category-link">
                              {{ product.title }}
                              <span class="product-count">${{ product.price | money_without_currency }}</span>
                            </a>
                          </li>
                        {% endfor %}
                      {% else %}
                        <!-- Fallback: Show popular product names -->
                        {% assign popular_products = "Hydrating Curl Cream,Defining Gel,Leave-In Conditioner,Moisture Mask,Shine Serum,Volume Spray" | split: ',' %}
                        {% for product_name in popular_products %}
                          <li class="category-item">
                            <a href="{{ routes.all_products_collection_url }}" class="category-link">
                              {{ product_name }}
                            </a>
                          </li>
                        {% endfor %}
                      {% endif %}
                      
                      <!-- View All Products Link -->
                      <li class="category-item">
                        <a href="{{ routes.all_products_collection_url }}" class="category-link" style="font-weight: 600; color: var(--primary-color);">
                          View All Products â†’
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>
            
            <!-- Quick Links -->
            <li class="sidebar-menu-item">
              <a href="{{ routes.all_products_collection_url }}" class="sidebar-menu-link">
                <span style="display: flex; align-items: center;">
                  <span class="all-products-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/>
                    </svg>
                  </span>
                  New Arrivals
                </span>
              </a>
            </li>
            
            <li class="sidebar-menu-item">
              <a href="{{ routes.search_url }}?sort_by=best-selling" class="sidebar-menu-link">
                <span style="display: flex; align-items: center;">
                  <span class="all-products-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M11.5 9.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM9 15.27l-1.45.66.35-1.6-1.2-1.15 1.6-.23L9 11.23l.7 1.52 1.6.23-1.2 1.15.35 1.6L9 15.27z"/>
                    </svg>
                  </span>
                  Best Sellers
                </span>
              </a>
            </li>
          </ul>
        </div>

        <!-- Educational & Content Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Education & Content</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#educational-content" class="sidebar-menu-link">
                Educational Content
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#quiz" class="sidebar-menu-link">
                Hair Quiz
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#faq" class="sidebar-menu-link">
                FAQ
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#science-technology" class="sidebar-menu-link">
                Science & Technology
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#ingredients-spotlight" class="sidebar-menu-link">
                Ingredients Spotlight
              </a>
            </li>
          </ul>
        </div>

        <!-- Products Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Products</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#featured-products" class="sidebar-menu-link">
                Featured Products
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#featured-collections" class="sidebar-menu-link">
                Featured Collections
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#product-benefits" class="sidebar-menu-link">
                Product Benefits
              </a>
            </li>
          </ul>
        </div>

        <!-- Services & Expert Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Services & Experts</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#services-by-concern" class="sidebar-menu-link">
                Services by Concern
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#expert-endorsements" class="sidebar-menu-link">
                Expert Endorsements
              </a>
            </li>
          </ul>
        </div>

        <!-- Trust & Community Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Trust & Community</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#trust-indicators" class="sidebar-menu-link">
                Trust Indicators
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#ugc-gallery" class="sidebar-menu-link">
                User Gallery
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#before-after" class="sidebar-menu-link">
                Before & After
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="{{ routes.search_url }}" class="sidebar-menu-link">
                Search
              </a>
            </li>
          </ul>
        </div>

        <!-- Hero & About Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">About</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#hero" class="sidebar-menu-link">
                Home Hero
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="{{ pages['about'].url | default: '#' }}" class="sidebar-menu-link">
                Our Story
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>

    <div class="sidebar-footer">
      {% if customer %}
        <a href="{{ routes.account_url }}" class="sidebar-account">
          <div style="width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color), #D4A59A); display: flex; align-items: center; justify-content: center; color: white;">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
          </div>
          <div>
            <span style="display: block; font-size: 14px; font-weight: 600;">{{ customer.name | truncate: 20 }}</span>
            <span style="display: block; font-size: 12px; color: #666;">{{ customer.email | truncate: 25 }}</span>
          </div>
        </a>
      {% else %}
        <a href="{{ routes.account_login_url }}" class="sidebar-account">
          <div style="width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color), #D4A59A); display: flex; align-items: center; justify-content: center; color: white;">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
          </div>
          <div>
            <span style="display: block; font-size: 14px; font-weight: 600;">Sign In</span>
            <span style="display: block; font-size: 12px; color: #666;">Access your account</span>
          </div>
        </a>
      {% endif %}

      <!-- Cart Summary -->
      <div style="margin-top: 16px; padding: 16px; background: rgba(232, 196, 184, 0.05); border-radius: 8px;">
        <a href="{{ routes.cart_url }}" style="display: flex; align-items: center; justify-content: space-between; text-decoration: none; color: var(--text-dark);">
          <span style="font-weight: 500;">View Cart</span>
          <span style="background: var(--primary-color); color: white; border-radius: 12px; padding: 4px 12px; font-size: 13px; font-weight: 600;">
            {{ cart.item_count }} item{% if cart.item_count != 1 %}s{% endif %}
          </span>
        </a>
      </div>
    </div>
  </aside>

  <!-- MOBILE HEADER (Visible only on mobile/tablet) -->
  <header class="mobile-header">
    <div class="header-container">
      <div class="header-inner">
        <!-- Hamburger Menu Button -->
        <button class="sidebar-toggle" id="sidebarToggle" aria-label="Open menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </button>

        <!-- Logo -->
        <div class="logo">
          <a href="{{ routes.root_url }}">
            <img 
              src="https://cdn.shopify.com/s/files/1/0567/4172/4316/files/logo.jpg?v=1764436849" 
              alt="{{ shop.name }}"
              width="120"
              height="40"
              loading="eager"
            >
          </a>
        </div>

        <!-- Header Actions -->
        <div class="header-actions">
          <a href="{{ routes.search_url }}" class="header-action search-btn" aria-label="Search">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
            </svg>
          </a>
          <a href="{{ routes.account_login_url }}" class="header-action account-btn" aria-label="Account">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
          </a>
          <a href="{{ routes.cart_url }}" class="header-action cart-btn" aria-label="Cart">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 a1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/>
            </svg>
            <span class="cart-count">{{ cart.item_count }}</span>
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- MOBILE SIDEBAR (Visible only on mobile/tablet) -->
  <aside class="mobile-sidebar" id="mobileSidebar">
    <div class="sidebar-header">
      <a href="{{ routes.root_url }}" class="sidebar-logo">
        <img 
          src="https://cdn.shopify.com/s/files/1/0567/4172/4316/files/logo.jpg?v=1764436849" 
          alt="{{ shop.name }}"
          width="140"
          height="35"
          loading="eager"
        >
      </a>
      <button class="sidebar-close" id="mobileSidebarClose" aria-label="Close menu">
        &times;
      </button>
    </div>

    <div class="sidebar-content">
      <nav class="sidebar-nav">
        <!-- Shop Section - MOBILE VERSION -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Shop</div>
          <ul class="sidebar-menu">
            <!-- Single "All Products" with Categories Dropdown (Mobile) -->
            <li class="sidebar-menu-item mobile-category-item">
              <button class="sidebar-menu-link mobile-all-products-btn">
                <span style="display: flex; align-items: center;">
                  <span class="all-products-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M10 3H4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1zm10 0h-6a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1zM10 13H4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1zm10 0h-6a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1z"/>
                    </svg>
                  </span>
                  All Products
                </span>
                <span class="sidebar-menu-count">{{ collections.all.products_count | default: 0 }}</span>
                <span class="mobile-arrow">â€º</span>
              </button>
              
              <!-- Mobile Categories Dropdown -->
              <div class="categories-dropdown mobile-categories-dropdown">
                <div class="categories-grid">
                  <!-- Product Type Column -->
                  <div class="category-column">
                    <div class="category-column-title">Shop by Category</div>
                    <ul class="category-list">
                      <!-- Get all collections (or featured collections) -->
                      {% assign main_collections = collections %}
                      
                      {% if main_collections.size > 0 %}
                        {% for collection in main_collections limit: 6 %}
                          {% unless collection.handle == 'all' or collection.handle == 'frontpage' %}
                            <li class="category-item">
                              <a href="{{ collection.url }}" class="category-link" onclick="closeMobileSidebar()">
                                {{ collection.title }}
                                {% if collection.products_count > 0 %}
                                  <span class="product-count">{{ collection.products_count }}</span>
                                {% endif %}
                              </a>
                            </li>
                          {% endunless %}
                        {% endfor %}
                      {% else %}
                        <!-- Fallback: Show hardcoded product categories -->
                        {% assign product_categories = "Shampoos,Conditioners,Curl Creams,Hair Oils,Styling Products,Treatments" | split: ',' %}
                        {% for category in product_categories %}
                          <li class="category-item">
                            <a href="{{ routes.collections_url }}" class="category-link" onclick="closeMobileSidebar()">
                              {{ category }}
                            </a>
                          </li>
                        {% endfor %}
                      {% endif %}
                      
                      <!-- View All Collections Link -->
                      <li class="category-item">
                        <a href="{{ routes.collections_url }}" class="category-link" style="font-weight: 600; color: var(--primary-color);" onclick="closeMobileSidebar()">
                          View All Collections â†’
                        </a>
                      </li>
                    </ul>
                  </div>
                  
                  <!-- Quick Links Column -->
                  <div class="category-column">
                    <div class="category-column-title">Quick Links</div>
                    <ul class="category-list">
                      <li class="category-item">
                        <a href="{{ routes.all_products_collection_url }}" class="category-link" onclick="closeMobileSidebar()">
                          All Products
                        </a>
                      </li>
                      <li class="category-item">
                        <a href="{{ routes.search_url }}?sort_by=best-selling" class="category-link" onclick="closeMobileSidebar()">
                          Best Sellers
                        </a>
                      </li>
                      <li class="category-item">
                        <a href="{{ routes.search_url }}?sort_by=created-descending" class="category-link" onclick="closeMobileSidebar()">
                          New Arrivals
                        </a>
                      </li>
                      <li class="category-item">
                        <a href="{{ routes.search_url }}?q=sale&options%5Bprefix%5D=last" class="category-link" onclick="closeMobileSidebar()">
                          On Sale
                        </a>
                      </li>
                      <li class="category-item">
                        <a href="{{ routes.search_url }}" class="category-link" onclick="closeMobileSidebar()">
                          Search Products
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>
          </ul>
        </div>

        <!-- Continue with other sections... -->
        <!-- Educational & Content Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Education & Content</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#educational-content" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Educational Content
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#quiz" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Hair Quiz
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#faq" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                FAQ
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#science-technology" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Science & Technology
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#ingredients-spotlight" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Ingredients Spotlight
              </a>
            </li>
          </ul>
        </div>

        <!-- Products Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Products</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#featured-products" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Featured Products
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#featured-collections" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Featured Collections
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#product-benefits" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Product Benefits
              </a>
            </li>
          </ul>
        </div>

        <!-- Services & Expert Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Services & Experts</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#services-by-concern" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Services by Concern
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#expert-endorsements" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Expert Endorsements
              </a>
            </li>
          </ul>
        </div>

        <!-- Trust & Community Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">Trust & Community</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#trust-indicators" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Trust Indicators
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#ugc-gallery" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                User Gallery
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="#before-after" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Before & After
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="{{ routes.search_url }}" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Search
              </a>
            </li>
          </ul>
        </div>

        <!-- Hero & About Section -->
        <div class="sidebar-section">
          <div class="sidebar-section-title">About</div>
          <ul class="sidebar-menu">
            <li class="sidebar-menu-item">
              <a href="#hero" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Home Hero
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="{{ pages['about'].url | default: '#' }}" class="sidebar-menu-link" onclick="closeMobileSidebar()">
                Our Story
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>

    <div class="sidebar-footer">
      {% if customer %}
        <a href="{{ routes.account_url }}" class="sidebar-account" onclick="closeMobileSidebar()">
          <div style="width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color), #D4A59A); display: flex; align-items: center; justify-content: center; color: white;">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
          </div>
          <div>
            <span style="display: block; font-size: 14px; font-weight: 600;">{{ customer.name | truncate: 20 }}</span>
            <span style="display: block; font-size: 12px; color: #666;">{{ customer.email | truncate: 25 }}</span>
          </div>
        </a>
      {% else %}
        <a href="{{ routes.account_login_url }}" class="sidebar-account" onclick="closeMobileSidebar()">
          <div style="width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color), #D4A59A); display: flex; align-items: center; justify-content: center; color: white;">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
          </div>
          <div>
            <span style="display: block; font-size: 14px; font-weight: 600;">Sign In</span>
            <span style="display: block; font-size: 12px; color: #666;">Access your account</span>
          </div>
        </a>
      {% endif %}

      <!-- Cart Summary -->
      <div style="margin-top: 16px; padding: 16px; background: rgba(232, 196, 184, 0.05); border-radius: 8px;">
        <a href="{{ routes.cart_url }}" style="display: flex; align-items: center; justify-content: space-between; text-decoration: none; color: var(--text-dark);" onclick="closeMobileSidebar()">
          <span style="font-weight: 500;">View Cart</span>
          <span style="background: var(--primary-color); color: white; border-radius: 12px; padding: 4px 12px; font-size: 13px; font-weight: 600;">
            {{ cart.item_count }} item{% if cart.item_count != 1 %}s{% endif %}
          </span>
        </a>
      </div>
    </div>
  </aside>

  <!-- Mobile Sidebar Overlay -->
  <div class="mobile-sidebar-overlay" id="mobileSidebarOverlay"></div>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    console.log('âœ… Mobile sidebar script loaded');
    
    // Mobile elements
    const sidebarToggle = document.getElementById('sidebarToggle');
    const mobileSidebar = document.getElementById('mobileSidebar');
    const mobileSidebarClose = document.getElementById('mobileSidebarClose');
    const mobileSidebarOverlay = document.getElementById('mobileSidebarOverlay');
    
    // Mobile "All Products" toggle
    const mobileAllProductsBtn = document.querySelector('.mobile-all-products-btn');
    
    // Check if we're on mobile/tablet
    const isMobile = window.innerWidth <= 1024;
    
    // Make closeMobileSidebar function globally accessible
    window.closeMobileSidebar = function() {
      console.log('ðŸ‘ˆ Closing sidebar');
      mobileSidebar.classList.remove('active');
      mobileSidebarOverlay.classList.remove('active');
      document.body.classList.remove('mobile-sidebar-open');
      document.body.style.overflow = '';
      
      // Close any open dropdowns
      const openDropdowns = document.querySelectorAll('.mobile-category-item.active');
      openDropdowns.forEach(item => {
        item.classList.remove('active');
        const dropdown = item.querySelector('.mobile-categories-dropdown');
        if (dropdown) dropdown.classList.remove('active');
      });
    };
    
    if (isMobile) {
      console.log('ðŸ“± Setting up mobile sidebar');
      
      // Make sure elements exist
      if (!sidebarToggle || !mobileSidebar) {
        console.error('âŒ Mobile sidebar elements not found');
        return;
      }
      
      // Open mobile sidebar
      function openMobileSidebar() {
        console.log('ðŸ‘‰ Opening sidebar');
        mobileSidebar.classList.add('active');
        mobileSidebarOverlay.classList.add('active');
        document.body.classList.add('mobile-sidebar-open');
        document.body.style.overflow = 'hidden';
      }
      
      // Toggle mobile sidebar
      function toggleMobileSidebar() {
        if (mobileSidebar.classList.contains('active')) {
          window.closeMobileSidebar();
        } else {
          openMobileSidebar();
        }
      }
      
      // Event listeners
      sidebarToggle.addEventListener('click', toggleMobileSidebar);
      mobileSidebarClose.addEventListener('click', window.closeMobileSidebar);
      mobileSidebarOverlay.addEventListener('click', window.closeMobileSidebar);
      
      // Mobile: Toggle "All Products" categories
      if (mobileAllProductsBtn) {
        mobileAllProductsBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          const parentItem = this.closest('.mobile-category-item');
          const dropdown = parentItem.querySelector('.mobile-categories-dropdown');
          
          parentItem.classList.toggle('active');
          dropdown.classList.toggle('active');
        });
      }
      
      // Escape key to close
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && mobileSidebar.classList.contains('active')) {
          window.closeMobileSidebar();
        }
      });
    }
    
    // Desktop: Handle "All Products" hover
    if (!isMobile) {
      const desktopAllProductsItems = document.querySelectorAll('.has-dropdown');
      
      desktopAllProductsItems.forEach(item => {
        const dropdown = item.querySelector('.categories-dropdown');
        
        // Show on hover
        item.addEventListener('mouseenter', function() {
          dropdown.classList.add('active');
        });
        
        // Hide when mouse leaves both button and dropdown
        item.addEventListener('mouseleave', function(e) {
          // Check if mouse is leaving to outside the entire item
          if (!this.contains(e.relatedTarget)) {
            dropdown.classList.remove('active');
          }
        });
        
        // Keep dropdown open when hovering over it
        dropdown.addEventListener('mouseenter', function() {
          dropdown.classList.add('active');
        });
        
        dropdown.addEventListener('mouseleave', function(e) {
          if (!this.contains(e.relatedTarget)) {
            dropdown.classList.remove('active');
          }
        });
      });
    }
    
    // Handle window resize
    let resizeTimer;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(function() {
        // Close sidebar if switching from mobile to desktop
        if (window.innerWidth > 1024 && mobileSidebar.classList.contains('active')) {
          window.closeMobileSidebar();
        }
      }, 250);
    });
    
    // Update cart count dynamically
    function updateCartCount() {
      const cartCounts = document.querySelectorAll('.cart-count');
      fetch('/cart.json')
        .then(response => response.json())
        .then(cart => {
          const count = cart.item_count || 0;
          cartCounts.forEach(element => {
            element.textContent = count;
          });
          
          // Update cart text in sidebars
          const cartTexts = document.querySelectorAll('.sidebar-footer span:last-child');
          cartTexts.forEach(element => {
            element.textContent = `${count} item${count !== 1 ? 's' : ''}`;
          });
        })
        .catch(error => {
          console.log('Error fetching cart:', error);
        });
    }
    
    // Initialize cart count
    updateCartCount();
    
    // Optional: Listen for cart updates if using AJAX cart
    document.addEventListener('cart:updated', updateCartCount);
  });
  </script>

  <main id="MainContent">
    {{ content_for_layout }}
  </main>
</html>