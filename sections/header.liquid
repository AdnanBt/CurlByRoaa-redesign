<header class="site-header">
  <!-- SIDEBAR TRIGGER (HAMBURGER ICON) -->
  <button id="sidebarToggle"
    class="lg:hidden p-3 text-gray-700"
    aria-label="Open sidebar">
    <svg width="26" height="26" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <line x1="3" y1="12" x2="21" y2="12"/>
      <line x1="3" y1="6" x2="21" y2="6"/>
      <line x1="3" y1="18" x2="21" y2="18"/>
    </svg>
  </button>

  <!-- LOGO -->
  <div class="header-logo">
    <a href="{{ routes.root_url }}">
      <img 
        src="{{ settings.logo | image_url: width: 160 }}"
        alt="Logo"
        width="160" height="48"
        loading="lazy"
      >
    </a>
  </div>

  <!-- NORMAL TOP NAV (DESKTOP) -->
  <nav class="desktop-nav hidden lg:flex gap-8 items-center">
    {% for link in linklists.main-menu.links %}
      <div class="relative group">
        <a href="{{ link.url }}" class="hover:text-black">
          {{ link.title }}
        </a>

        {% if link.links.size > 0 %}
        <div class="dropdown-menu absolute top-full left-0 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 bg-white border shadow-lg min-w-[200px] p-4 z-50">
          <ul class="space-y-3">
            {% for child in link.links %}
            <li>
              <a href="{{ child.url }}" class="text-gray-700 hover:text-black">
                {{ child.title }}
              </a>
            </li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
      </div>
    {% endfor %}
  </nav>

  <!-- CART / ACCOUNT -->
  <div class="flex gap-4 items-center">
    <a href="{{ routes.cart_url }}">
      <svg width="24" height="24" stroke="currentColor" fill="none">
        <circle cx="9" cy="21" r="1"></circle>
        <circle cx="20" cy="21" r="1"></circle>
        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
      </svg>
    </a>
  </div>

  <!-- SIDEBAR PANEL -->
  <aside id="sidebarPanel"
    class="fixed top-0 left-0 h-full w-[260px] bg-white shadow-xl z-[9999] transform -translate-x-full transition-transform duration-300 overflow-y-auto">

    <!-- Sidebar Header -->
    <div class="flex items-center justify-between p-4 border-b">
      <div class="text-lg font-semibold">Menu</div>
      <button id="sidebarClose" aria-label="Close sidebar">
        <svg width="26" height="26" stroke="currentColor" fill="none">
          <line x1="6" y1="6" x2="18" y2="18" stroke-width="2"/>
          <line x1="6" y1="18" x2="18" y2="6" stroke-width="2"/>
        </svg>
      </button>
    </div>

    <!-- Sidebar nav items -->
    <nav class="p-4 space-y-4">
      {% for link in linklists.main-menu.links %}
      <div>
        <button
          class="w-full text-left font-medium flex justify-between items-center py-2"
          data-sidebar-dropdown>
          {{ link.title }}
          {% if link.links.size > 0 %}
          <span>+</span>
          {% endif %}
        </button>

        {% if link.links.size > 0 %}
        <div class="sidebar-submenu hidden pl-4 space-y-2">
          {% for child in link.links %}
          <a href="{{ child.url }}" class="block text-gray-700 py-1">
            {{ child.title }}
          </a>
          {% endfor %}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </nav>

  </aside>

</header>

<!-- SIDEBAR JS -->
<script defer>
document.addEventListener("DOMContentLoaded", () => {
  const sidebar = document.getElementById("sidebarPanel");
  const openBtn = document.getElementById("sidebarToggle");
  const closeBtn = document.getElementById("sidebarClose");

  openBtn.addEventListener("click", () => {
    sidebar.classList.remove("-translate-x-full");
  });

  closeBtn.addEventListener("click", () => {
    sidebar.classList.add("-translate-x-full");
  });

  // Dropdowns inside sidebar
  document.querySelectorAll("[data-sidebar-dropdown]").forEach(btn => {
    btn.addEventListener("click", () => {
      const submenu = btn.nextElementSibling;
      submenu.classList.toggle("hidden");
    });
  });
});
</script>

<style>
/* Keep your dropdown styles consistent */
.dropdown-menu ul li a {
  transition: color .2s ease;
}

@media (max-width: 768px) {
  .desktop-nav { display: none !important; }
}
</style>
