<!DOCTYPE html>
<html lang="{{ request.locale.iso_code }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="preconnect" href="https://cdn.shopify.com">
  {{ content_for_header }}
  
  <style>
    /* ==================== */
    /* HEADER STYLES */
    /* ==================== */
    
    :root {
      --header-height: 80px;
      --announcement-height: 40px;
      --primary-color: #E8C4B8;
      --text-dark: #2D2D2D;
      --text-light: #666666;
      --white: #FFFFFF;
      --gray-light: #f9f9f9;
      --sidebar-width: 320px;
    }

    /* Reset body padding */
    body {
      padding-top: var(--header-height);
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    /* Announcement Bar */
    .announcement-bar {
      background: #f5f5f5;
      padding: 10px 0;
      text-align: center;
      font-size: 14px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1003;
    }

    /* Main Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: var(--header-height);
      background: var(--white);
      border-bottom: 1px solid rgba(0, 0, 0, 0.08);
      z-index: 1002;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    body.has-announcement .header {
      top: var(--announcement-height);
    }

    body.has-announcement {
      padding-top: calc(var(--header-height) + var(--announcement-height));
    }

    .header-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
      height: 100%;
    }

    .header-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 100%;
    }

    /* Logo */
    .logo {
      z-index: 1002;
    }

    .logo img {
      height: 40px;
      width: auto;
      max-width: 120px;
      object-fit: contain;
    }

    /* Sidebar Toggle Button - HIDDEN ON DESKTOP */
    .sidebar-toggle {
      display: none;
      background: none;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: var(--text-dark);
      transition: all 0.3s ease;
      z-index: 1002;
      padding: 0;
    }

    .sidebar-toggle:hover {
      background: rgba(232, 196, 184, 0.1);
      color: var(--primary-color);
    }

    /* ==================== */
    /* DESKTOP NAVIGATION (1025px and up) */
    /* ==================== */
    .nav-main {
      display: flex;
      gap: 40px;
      align-items: center;
    }

    .nav-item {
      position: relative;
    }

    .nav-link {
      text-decoration: none;
      color: var(--text-dark);
      font-weight: 500;
      font-size: 14px;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      padding: 8px 0;
      transition: color 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .nav-link.has-dropdown::after {
      content: '›';
      font-size: 16px;
      transform: rotate(90deg);
      transition: transform 0.3s ease;
    }

    .nav-item:hover .nav-link.has-dropdown::after {
      transform: rotate(-90deg);
    }

    .nav-link:hover {
      color: var(--primary-color);
    }

    /* Desktop Mega Dropdown */
    .mega-dropdown {
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(12px);
      width: 800px;
      background: var(--white);
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      z-index: 1001;
      padding: 40px;
      pointer-events: none;
    }

    .nav-item:hover .mega-dropdown {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(0);
      pointer-events: auto;
    }

    /* Left-side dropdown (Shop) */
    .nav-item:first-child .mega-dropdown {
      left: 0;
      transform: translateX(0) translateY(12px);
    }

    .nav-item:first-child:hover .mega-dropdown {
      transform: translateX(0) translateY(0);
    }

    /* Right-side dropdowns */
    .nav-item:nth-last-child(-n+2) .mega-dropdown {
      left: auto;
      right: 0;
      transform: translateX(0) translateY(12px);
    }

    .nav-item:nth-last-child(-n+2):hover .mega-dropdown {
      transform: translateX(0) translateY(0);
    }

    /* Dropdown Content */
    .dropdown-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
     
    }

    .dropdown-column h4 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .dropdown-links {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .dropdown-link {
      text-decoration: none;
      font-size: 14px;
      color: var(--text-dark);
      transition: all 0.3s ease;
      padding: 8px 0;
      border-bottom: 1px solid transparent;
      display: block;
    }

    .dropdown-link:hover {
      color: var(--primary-color);
      border-bottom-color: var(--primary-color);
      transform: translateX(8px);
    }

    /* Header Actions */
    .header-actions {
      display: flex;
      align-items: center;
      gap: 16px;
      z-index: 1002;
    }

    .header-action {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      text-decoration: none;
      color: var(--text-dark);
      transition: all 0.3s ease;
      position: relative;
    }

    .header-action:hover {
      background: rgba(232, 196, 184, 0.1);
      color: var(--primary-color);
    }

    .cart-count {
      background: var(--primary-color);
      color: var(--white);
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 11px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      top: -2px;
      right: -2px;
    }

    /* ==================== */
    /* TABLET & MOBILE STYLES (1024px and below) */
    /* ==================== */
    @media (max-width: 1024px) {
      /* Hide desktop navigation */
      .nav-main {
        display: none !important;
      }
      
      /* Show hamburger menu */
      .sidebar-toggle {
        display: flex;
      }
      
      /* Adjust logo position */
      .logo {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
      }
    }

    /* Mobile specific */
    @media (max-width: 768px) {
      :root {
        --header-height: 70px;
      }
      
      .logo img {
        height: 35px;
      }
      
      .header-action {
        width: 36px;
        height: 36px;
      }
      
      .announcement-bar {
        position: relative;
        top: auto;
      }
      
      body.has-announcement .header {
        top: 0;
      }
      
      body.has-announcement {
        padding-top: var(--header-height);
      }
    }

    /* ==================== */
    /* SIDEBAR FOR TABLET/MOBILE */
    /* ==================== */
    
    .unified-sidebar {
      position: fixed;
      top: 0;
      left:0;
      width: 50%;
      height: 50vh;
      background: var(--white);
      z-index: 1002;
      transition: left 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      overflow: hidden;
      visibility: hidden;
    }

    @media (min-width: 768px) {
      .unified-sidebar {
        width: var(--sidebar-width);
        left: calc(-1 * var(--sidebar-width));
        box-shadow: 2px 0 40px rgba(0, 0, 0, 0.12);
      }
    }

    .unified-sidebar.active {
      left: 0;
      visibility: visible;
    }

    /* Sidebar Overlay */
    .unified-sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 99998;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      backdrop-filter: blur(4px);
    }

    .unified-sidebar-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    /* Sidebar Inner */
    .unified-sidebar__inner {
      height: 100%;
      display: flex;
      flex-direction: column;
      background: var(--white);
    }

    /* Sidebar Header */
    .unified-sidebar__header {
      padding: 20px 24px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.08);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
      background: var(--white);
    }

    .unified-sidebar__logo {
      display: block;
    }

    .unified-sidebar__logo img {
      height: 35px;
      width: auto;
      max-width: 140px;
      object-fit: contain;
    }

    .unified-sidebar__close {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: var(--text-dark);
      font-size: 24px;
      transition: all 0.3s ease;
      padding: 0;
    }

    .unified-sidebar__close:hover {
      background: rgba(232, 196, 184, 0.1);
      color: var(--primary-color);
    }

    /* Sidebar Content */
    .unified-sidebar__content {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 0 0 40px 0;
      -webkit-overflow-scrolling: touch;
    }

    /* Sidebar Navigation */
    .unified-nav {
      padding: 0;
    }

    .unified-nav__section {
      padding: 0;
    }

    .unified-nav__title {
      padding: 16px 24px 8px;
      font-size: 12px;
      font-weight: 600;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin: 0;
    }

    .unified-nav__list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .unified-nav__item {
      margin: 0;
    }

    .unified-nav__link {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      text-decoration: none;
      color: var(--text-dark);
      font-size: 15px;
      font-weight: 500;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
      width: 100%;
      text-align: left;
      background: none;
      border: none;
      font-family: inherit;
    }

    .unified-nav__link:hover,
    .unified-nav__link.active {
      background: rgba(232, 196, 184, 0.08);
      color: var(--primary-color);
      border-left-color: var(--primary-color);
    }

    .unified-nav__link.has-children::after {
      content: '›';
      font-size: 18px;
      transform: rotate(90deg);
      transition: transform 0.3s ease;
    }

    .unified-nav__link.has-children.expanded::after {
      transform: rotate(-90deg);
    }

    .unified-nav__count {
      font-size: 12px;
      color: #888;
      background: rgba(0, 0, 0, 0.05);
      padding: 2px 10px;
      border-radius: 12px;
      margin-left: 8px;
    }

    /* Submenu */
    .unified-nav__submenu {
      background: rgba(0, 0, 0, 0.02);
      border-left: 4px solid rgba(232, 196, 184, 0.3);
      display: none;
    }

    .unified-nav__submenu.active {
      display: block;
    }

    .unified-nav__subitem {
      margin: 0;
    }

    .unified-nav__sublink {
      display: flex;
      align-items: center;
      padding: 14px 24px 14px 48px;
      text-decoration: none;
      color: #666;
      font-size: 14px;
      font-weight: 400;
      transition: all 0.3s ease;
    }

    .unified-nav__sublink:hover {
      color: var(--primary-color);
      background: rgba(232, 196, 184, 0.05);
    }

    /* Sidebar Footer */
    .unified-sidebar__footer {
      padding: 20px 24px;
      border-top: 1px solid rgba(0, 0, 0, 0.08);
      background: var(--white);
      flex-shrink: 0;
    }

    .unified-sidebar__account {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      text-decoration: none;
      color: var(--text-dark);
      border-radius: 8px;
      transition: all 0.3s ease;
      background: rgba(0, 0, 0, 0.02);
    }

    .unified-sidebar__account:hover {
      background: rgba(232, 196, 184, 0.1);
      color: var(--primary-color);
    }

    .unified-sidebar__account-icon {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary-color), #D4A59A);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .unified-sidebar__cart {
      margin-top: 16px;
      padding: 16px;
      background: rgba(232, 196, 184, 0.05);
      border-radius: 8px;
      border: 1px solid rgba(232, 196, 184, 0.2);
    }

    .unified-sidebar__cart-link {
      display: flex;
      align-items: center;
      justify-content: space-between;
      text-decoration: none;
      color: var(--text-dark);
      font-weight: 500;
    }

    .unified-sidebar__cart-count {
      background: var(--primary-color);
      color: white;
      border-radius: 12px;
      padding: 4px 12px;
      font-size: 13px;
      font-weight: 600;
    }

    /* Body lock when sidebar is open */
    body.sidebar-open {
      overflow: hidden;
    }

    /* Scrollbar */
    .unified-sidebar__content::-webkit-scrollbar {
      width: 4px;
    }

    .unified-sidebar__content::-webkit-scrollbar-thumb {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 4px;
    }

    /* Hide sidebar on desktop */
    @media (min-width: 1025px) {
      .unified-sidebar,
      .unified-sidebar-overlay {
        display: none !important;
      }
    }

    /* Mobile adjustments */
    @media (max-width: 767px) {
      .unified-sidebar {
        width: 85%;
        max-width: 320px;
      }
    }
  </style>
</head>
<body>
  <!-- Announcement Bar -->
  {%- if section.settings.announcement_text != blank -%}
    <div class="announcement-bar">
      <p>{{ section.settings.announcement_text }}</p>
    </div>
  {%- endif -%}

  <!-- Main Header -->
  <header class="header" id="main-header">
    <div class="header-container">
      <div class="header-inner">
        <!-- Sidebar Toggle Button (Visible only on Tablet/Mobile) -->
        <button class="sidebar-toggle" id="sidebarToggle" aria-label="Open sidebar menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </button>

        <!-- Logo -->
        <div class="logo">
          <a href="{{ routes.root_url }}">
            <img 
              src="https://cdn.shopify.com/s/files/1/0567/4172/4316/files/logo.jpg?v=1764436849" 
              alt="{{ shop.name }}"
              width="120"
              height="40"
              loading="eager"
            >
          </a>
        </div>

        <!-- Desktop Navigation (Visible only on Desktop) -->
        <nav class="nav-main" id="main-nav">
          <!-- Shop Dropdown -->
          <div class="nav-item">
            <a href="{{ routes.all_products_collection_url }}" class="nav-link has-dropdown">Shop</a>
            <div class="mega-dropdown">
              <div class="dropdown-grid">
                <div class="dropdown-column">
                  <h4>By Product Type</h4>
                  <div class="dropdown-links">
                    {%- assign collections_to_show = 'shampoo,conditioner,curl-cream,hair-oil,styling,treatments' | split: ',' -%}
                    {%- for handle in collections_to_show -%}
                      {%- assign collection = collections[handle] -%}
                      <a href="{{ collection.url | default: routes.collections_url }}" class="dropdown-link">
                        {%- if collection -%}
                          {{ collection.title }}
                        {%- else -%}
                          {{ handle | replace: '-', ' ' | capitalize }}
                        {%- endif -%}
                      </a>
                    {%- endfor -%}
                  </div>
                </div>
                <div class="dropdown-column">
                  <h4>By Curl Type</h4>
                  <div class="dropdown-links">
                    {%- assign curl_collections = 'wavy-hair,curly-hair,coily-hair,fine-hair,thick-hair,damaged-hair' | split: ',' -%}
                    {%- for handle in curl_collections -%}
                      {%- assign collection = collections[handle] -%}
                      <a href="{{ collection.url | default: routes.collections_url }}" class="dropdown-link">
                        {%- if collection -%}
                          {{ collection.title }}
                        {%- else -%}
                          {{ handle | replace: '-', ' ' | capitalize }}
                        {%- endif -%}
                      </a>
                    {%- endfor -%}
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Hair Quiz -->
          <div class="nav-item">
            <a href="#hair-quiz" class="nav-link has-dropdown">Hair Quiz</a>
            <div class="mega-dropdown">
              <div class="dropdown-grid">
                <div class="dropdown-column">
                  <h4>Find Your Routine</h4>
                  <div class="dropdown-links">
                    <a href="#hair-quiz" class="dropdown-link">Start Hair Quiz</a>
                    <a href="#curl-pattern" class="dropdown-link">Curl Pattern Analysis</a>
                    <a href="#hair-concerns" class="dropdown-link">Hair Concerns Assessment</a>
                    <a href="#routine-builder" class="dropdown-link">Custom Routine Builder</a>
                  </div>
                </div>
                <div class="dropdown-column">
                  <h4>Quick Guides</h4>
                  <div class="dropdown-links">
                    <a href="#curl-type-guide" class="dropdown-link">Curl Type Identification</a>
                    <a href="#porosity-test" class="dropdown-link">Hair Porosity Test</a>
                    <a href="#density-guide" class="dropdown-link">Hair Density Guide</a>
                    <a href="#ingredients-guide" class="dropdown-link">Key Ingredients</a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Services by Concern -->
          <div class="nav-item">
            <a href="#services-by-concern" class="nav-link">Services by Concern</a>
          </div>

          <!-- Our Story -->
          <div class="nav-item">
            <a href="{{ pages['about'].url | default: '/pages/about' }}" class="nav-link has-dropdown">Our Story</a>
            <div class="mega-dropdown">
              <div class="dropdown-grid">
                <div class="dropdown-column">
                  <h4>About Us</h4>
                  <div class="dropdown-links">
                    <a href="{{ pages['our-mission'].url | default: '/pages/our-mission' }}" class="dropdown-link">Our Mission</a>
                    <a href="{{ pages['our-story'].url | default: '/pages/our-story' }}" class="dropdown-link">Brand Story</a>
                    <a href="{{ pages['ingredients'].url | default: '/pages/ingredients' }}" class="dropdown-link">Ingredient Philosophy</a>
                    <a href="{{ pages['sustainability'].url | default: '/pages/sustainability' }}" class="dropdown-link">Sustainability</a>
                  </div>
                </div>
                <div class="dropdown-column">
                  <h4>Community</h4>
                  <div class="dropdown-links">
                    <a href="{{ pages['curl-community'].url | default: '/pages/curl-community' }}" class="dropdown-link">Curl Community</a>
                    <a href="{{ pages['education'].url | default: '/pages/education' }}" class="dropdown-link">Hair Education</a>
                    <a href="{{ pages['events'].url | default: '/pages/events' }}" class="dropdown-link">Events & Workshops</a>
                    <a href="{{ pages['testimonials'].url | default: '/pages/testimonials' }}" class="dropdown-link">Success Stories</a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Guides -->
          <div class="nav-item">
            <a href="{{ blogs['guides'].url | default: '/blogs/guides' }}" class="nav-link has-dropdown">Guides</a>
            <div class="mega-dropdown">
              <div class="dropdown-grid">
                <div class="dropdown-column">
                  <h4>Hair Care Guides</h4>
                  <div class="dropdown-links">
                    {%- if blogs.guides.articles.size > 0 -%}
                      {%- for article in blogs.guides.articles limit: 4 -%}
                        <a href="{{ article.url }}" class="dropdown-link">{{ article.title }}</a>
                      {%- endfor -%}
                    {%- else -%}
                      <a href="{{ routes.blog_url }}" class="dropdown-link">Wash Day Routine</a>
                      <a href="{{ routes.blog_url }}" class="dropdown-link">Styling Techniques</a>
                      <a href="{{ routes.blog_url }}" class="dropdown-link">Night Time Routine</a>
                      <a href="{{ routes.blog_url }}" class="dropdown-link">Seasonal Hair Care</a>
                    {%- endif -%}
                  </div>
                </div>
                <div class="dropdown-column">
                  <h4>Expert Advice</h4>
                  <div class="dropdown-links">
                    <a href="{{ routes.blog_url }}/tagged/common-mistakes" class="dropdown-link">Common Mistakes</a>
                    <a href="{{ routes.blog_url }}/tagged/application" class="dropdown-link">Product Application</a>
                    <a href="{{ routes.blog_url }}/tagged/troubleshooting" class="dropdown-link">Troubleshooting Guide</a>
                    <a href="{{ routes.blog_url }}/tagged/pro-tips" class="dropdown-link">Professional Tips</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </nav>

        <!-- Header Actions -->
        <div class="header-actions">
          <a href="{{ routes.search_url }}" class="header-action search-btn" aria-label="Search">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
            </svg>
          </a>
          <a href="{{ routes.account_login_url }}" class="header-action account-btn" aria-label="Account">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
          </a>
          <a href="{{ routes.cart_url }}" class="header-action cart-btn" aria-label="Cart">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/>
            </svg>
            <span class="cart-count">{{ cart.item_count }}</span>
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Sidebar for Tablet/Mobile -->
  <aside class="unified-sidebar" id="unifiedSidebar" aria-hidden="true" role="dialog" aria-label="Main navigation menu">
    <div class="unified-sidebar__inner">
      <!-- Header -->
      <div class="unified-sidebar__header">
        <a href="{{ routes.root_url }}" class="unified-sidebar__logo">
          <img 
            src="https://cdn.shopify.com/s/files/1/0567/4172/4316/files/logo.jpg?v=1764436849" 
            alt="{{ shop.name }}"
            width="140"
            height="35"
            loading="eager"
          >
        </a>
        <button class="unified-sidebar__close" id="unifiedSidebarClose" aria-label="Close menu">
          &times;
        </button>
      </div>

      <!-- Scrollable Content -->
      <div class="unified-sidebar__content">
        <!-- Main Navigation -->
        <nav class="unified-nav" aria-label="Sidebar navigation">
          <!-- Shop Section -->
          <div class="unified-nav__section">
            <h3 class="unified-nav__title">Shop</h3>
            <ul class="unified-nav__list">
              <li class="unified-nav__item">
                <a href="{{ routes.all_products_collection_url }}" class="unified-nav__link">
                  All Products
                  <span class="unified-nav__count">{{ collections.all.products_count | default: 0 }}</span>
                </a>
              </li>

              <!-- Product Type Dropdown -->
              <li class="unified-nav__item">
                <button class="unified-nav__link has-children" data-toggle="submenu" data-target="product-type">
                  By Product Type
                </button>
                <div class="unified-nav__submenu" id="product-type">
                  {%- assign collections_to_show = 'shampoo,conditioner,curl-cream,hair-oil,styling,treatments' | split: ',' -%}
                  {%- for handle in collections_to_show -%}
                    {%- assign collection = collections[handle] -%}
                    <div class="unified-nav__subitem">
                      <a href="{{ collection.url | default: routes.collections_url }}" class="unified-nav__sublink">
                        {%- if collection -%}
                          {{ collection.title }}
                        {%- else -%}
                          {{ handle | replace: '-', ' ' | capitalize }}
                        {%- endif -%}
                      </a>
                    </div>
                  {%- endfor -%}
                </div>
              </li>

              <!-- Curl Type Dropdown -->
              <li class="unified-nav__item">
                <button class="unified-nav__link has-children" data-toggle="submenu" data-target="curl-type">
                  By Curl Type
                </button>
                <div class="unified-nav__submenu" id="curl-type">
                  {%- assign curl_collections = 'wavy-hair,curly-hair,coily-hair,fine-hair,thick-hair,damaged-hair' | split: ',' -%}
                  {%- for handle in curl_collections -%}
                    {%- assign collection = collections[handle] -%}
                    <div class="unified-nav__subitem">
                      <a href="{{ collection.url | default: routes.collections_url }}" class="unified-nav__sublink">
                        {%- if collection -%}
                          {{ collection.title }}
                        {%- else -%}
                          {{ handle | replace: '-', ' ' | capitalize }}
                        {%- endif -%}
                      </a>
                    </div>
                  {%- endfor -%}
                </div>
              </li>
            </ul>
          </div>

          <!-- Guides & Resources -->
          <div class="unified-nav__section">
            <h3 class="unified-nav__title">Guides & Resources</h3>
            <ul class="unified-nav__list">
              <li class="unified-nav__item">
                <a href="#hair-quiz" class="unified-nav__link">Hair Quiz</a>
              </li>
              <li class="unified-nav__item">
                <a href="{{ blogs['guides'].url | default: '/blogs/guides' }}" class="unified-nav__link">
                  Hair Care Guides
                </a>
              </li>
              <li class="unified-nav__item">
                <a href="#services-by-concern" class="unified-nav__link">Services by Concern</a>
              </li>
              <li class="unified-nav__item">
                <a href="{{ pages['about'].url | default: '/pages/about' }}" class="unified-nav__link">Our Story</a>
              </li>
            </ul>
          </div>

          <!-- Information -->
          <div class="unified-nav__section">
            <h3 class="unified-nav__title">Information</h3>
            <ul class="unified-nav__list">
              <li class="unified-nav__item">
                <a href="{{ routes.search_url }}" class="unified-nav__link">Search</a>
              </li>
              {%- for page in pages limit: 5 -%}
                {%- unless page.handle contains 'policy' -%}
                  <li class="unified-nav__item">
                    <a href="{{ page.url }}" class="unified-nav__link">{{ page.title }}</a>
                  </li>
                {%- endunless -%}
              {%- endfor -%}
            </ul>
          </div>
        </nav>
      </div>

      <!-- Footer -->
      <div class="unified-sidebar__footer">
        {% if customer %}
          <a href="{{ routes.account_url }}" class="unified-sidebar__account">
            <div class="unified-sidebar__account-icon">
              <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
              </svg>
            </div>
            <div>
              <span style="display: block; font-size: 14px; font-weight: 600;">{{ customer.name | truncate: 20 }}</span>
              <span style="display: block; font-size: 12px; color: #888;">{{ customer.email | truncate: 25 }}</span>
            </div>
          </a>
        {% else %}
          <a href="{{ routes.account_login_url }}" class="unified-sidebar__account">
            <div class="unified-sidebar__account-icon">
              <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
              </svg>
            </div>
            <div>
              <span style="display: block; font-size: 14px; font-weight: 600;">Sign In</span>
              <span style="display: block; font-size: 12px; color: #888;">Access your account</span>
            </div>
          </a>
        {% endif %}

        <!-- Cart Summary -->
        <div class="unified-sidebar__cart">
          <a href="{{ routes.cart_url }}" class="unified-sidebar__cart-link">
            <span>View Cart</span>
            <span class="unified-sidebar__cart-count">{{ cart.item_count }} item{% if cart.item_count != 1 %}s{% endif %}</span>
          </a>
        </div>
      </div>
    </div>
  </aside>

  <!-- Overlay -->
  <div class="unified-sidebar-overlay" id="unifiedSidebarOverlay"></div>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    console.log('Header script loaded');
    
    // Check announcement bar
    const announcementBar = document.querySelector('.announcement-bar');
    if (announcementBar) {
      document.body.classList.add('has-announcement');
    }
    
    // ====================
    // TABLET/MOBILE SIDEBAR
    // ====================
    const sidebar = document.getElementById('unifiedSidebar');
    const overlay = document.getElementById('unifiedSidebarOverlay');
    const toggleBtn = document.getElementById('sidebarToggle');
    const closeBtn = document.getElementById('unifiedSidebarClose');
    
    // Only initialize if elements exist (mobile/tablet)
    if (sidebar && toggleBtn) {
      // Toggle sidebar
      function toggleSidebar() {
        console.log('Toggle sidebar called');
        sidebar.classList.toggle('active');
        overlay.classList.toggle('active');
        document.body.classList.toggle('sidebar-open');
      }
      
      // Close sidebar
      function closeSidebar() {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
        document.body.classList.remove('sidebar-open');
      }
      
      // Event listeners for mobile sidebar
      toggleBtn.addEventListener('click', toggleSidebar);
      
      if (closeBtn) {
        closeBtn.addEventListener('click', closeSidebar);
      }
      
      if (overlay) {
        overlay.addEventListener('click', closeSidebar);
      }
      
      // Close with Escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && sidebar.classList.contains('active')) {
          closeSidebar();
        }
      });
      
      // Handle submenu toggles
      const submenuToggles = document.querySelectorAll('[data-toggle="submenu"]');
      submenuToggles.forEach(toggle => {
        toggle.addEventListener('click', function() {
          const targetId = this.getAttribute('data-target');
          const submenu = document.getElementById(targetId);
          if (submenu) {
            this.classList.toggle('expanded');
            submenu.classList.toggle('active');
          }
        });
      });
    }
    
    // ====================
    // DESKTOP DROPDOWNS
    // ====================
    const navItems = document.querySelectorAll('.nav-item');
    
    if (navItems.length > 0) {
      navItems.forEach(item => {
        const dropdown = item.querySelector('.mega-dropdown');
        if (!dropdown) return;
        
        item.addEventListener('mouseenter', function() {
          this.classList.add('hover');
          dropdown.style.opacity = '1';
          dropdown.style.visibility = 'visible';
          dropdown.style.pointerEvents = 'auto';
          
          // Position based on which dropdown it is
          if (item === navItems[0]) {
            dropdown.style.transform = 'translateX(0) translateY(0)';
          } else if (item === navItems[navItems.length - 1] || 
                     item === navItems[navItems.length - 2]) {
            dropdown.style.transform = 'translateX(0) translateY(0)';
          } else {
            dropdown.style.transform = 'translateX(-50%) translateY(0)';
          }
        });
        
        item.addEventListener('mouseleave', function() {
          this.classList.remove('hover');
          dropdown.style.opacity = '0';
          dropdown.style.pointerEvents = 'none';
          
          if (item === navItems[0]) {
            dropdown.style.transform = 'translateX(0) translateY(12px)';
          } else if (item === navItems[navItems.length - 1] || 
                     item === navItems[navItems.length - 2]) {
            dropdown.style.transform = 'translateX(0) translateY(12px)';
          } else {
            dropdown.style.transform = 'translateX(-50%) translateY(12px)';
          }
          
          setTimeout(() => {
            if (!this.classList.contains('hover')) {
              dropdown.style.visibility = 'hidden';
            }
          }, 300);
        });
      });
    }
    
    // Mark active link in sidebar
    function markActiveLink() {
      const currentUrl = window.location.pathname;
      const links = document.querySelectorAll('.unified-nav__link, .unified-nav__sublink');
      
      links.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href !== '#' && currentUrl.includes(href.replace(/^\//, '').split('?')[0])) {
          link.classList.add('active');
        }
      });
    }
    
    markActiveLink();
    
    // Update cart count
    function updateCartCount() {
      const cartCounts = document.querySelectorAll('.cart-count, .unified-sidebar__cart-count');
      const itemCount = {{ cart.item_count | default: 0 }};
      
      cartCounts.forEach(span => {
        if (span.classList.contains('cart-count')) {
          span.textContent = itemCount;
        } else if (span.classList.contains('unified-sidebar__cart-count')) {
          span.textContent = itemCount + ' item' + (itemCount !== 1 ? 's' : '');
        }
      });
    }
    
    updateCartCount();
    
    // Handle window resize
    let resizeTimer;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(function() {
        // Close sidebar if resizing to desktop
        if (window.innerWidth >= 1025 && sidebar && sidebar.classList.contains('active')) {
          sidebar.classList.remove('active');
          if (overlay) overlay.classList.remove('active');
          document.body.classList.remove('sidebar-open');
        }
      }, 250);
    });
    
    console.log('Header initialized successfully');
  });
  </script>

  <main id="MainContent">
    {{ content_for_layout }}
  </main>
</body>
</html>