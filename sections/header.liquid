<!DOCTYPE html>
<html lang="{{ request.locale.iso_code }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="preconnect" href="https://cdn.shopify.com">
  {{ content_for_header }}
  
  <style>
    /* ==================== */
    /* BASE VARIABLES */
    /* ==================== */
    :root {
      --header-height: 80px;
      --primary-color: #E8C4B8;
      --text-dark: #2D2D2D;
      --white: #FFFFFF;
    }

    /* ==================== */
    /* BASIC RESET */
    /* ==================== */
    body {
      margin: 0;
      padding-top: var(--header-height);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    /* ==================== */
    /* HEADER STYLES */
    /* ==================== */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: var(--header-height);
      background: var(--white);
      border-bottom: 1px solid rgba(0, 0, 0, 0.08);
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .header-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
      height: 100%;
    }

    .header-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 100%;
    }

    /* Logo */
    .logo img {
      height: 40px;
      width: auto;
      max-width: 120px;
      object-fit: contain;
    }

    /* Sidebar Toggle Button - ALWAYS VISIBLE */
    .sidebar-toggle {
      background: none;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: var(--text-dark);
      transition: all 0.3s ease;
      padding: 0;
    }

    .sidebar-toggle:hover {
      background: rgba(232, 196, 184, 0.1);
      color: var(--primary-color);
    }

    /* Header Actions */
    .header-actions {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .header-action {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      text-decoration: none;
      color: var(--text-dark);
      transition: all 0.3s ease;
      position: relative;
    }

    .header-action:hover {
      background: rgba(232, 196, 184, 0.1);
      color: var(--primary-color);
    }

    .cart-count {
      background: var(--primary-color);
      color: var(--white);
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 11px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      top: -2px;
      right: -2px;
    }

    /* ==================== */
    /* SIDEBAR STYLES */
    /* ==================== */
    .sidebar {
      position: fixed;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100vh;
      background: var(--white);
      z-index: 9999;
      transition: left 0.3s ease;
      overflow-y: auto;
    }

    @media (min-width: 768px) {
      .sidebar {
        width: 320px;
        left: -320px;
        box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
      }
    }

    .sidebar.active {
      left: 0;
    }

    /* Sidebar Overlay */
    .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9998;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .sidebar-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    /* Sidebar Header */
    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.08);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .sidebar-logo img {
      height: 35px;
      width: auto;
      max-width: 140px;
    }

    .sidebar-close {
      background: none;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 24px;
      color: var(--text-dark);
      transition: all 0.3s ease;
    }

    .sidebar-close:hover {
      background: rgba(232, 196, 184, 0.1);
      color: var(--primary-color);
    }

    /* Sidebar Content */
    .sidebar-content {
      padding: 20px 0;
    }

    /* Sidebar Navigation */
    .sidebar-section {
      margin-bottom: 20px;
    }

    .sidebar-section-title {
      padding: 0 20px 10px;
      font-size: 13px;
      font-weight: 600;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .sidebar-menu {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar-menu-item {
      margin: 0;
    }

    .sidebar-menu-link {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 20px;
      text-decoration: none;
      color: var(--text-dark);
      font-size: 15px;
      font-weight: 500;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }

    .sidebar-menu-link:hover,
    .sidebar-menu-link.active {
      background: rgba(232, 196, 184, 0.08);
      color: var(--primary-color);
      border-left-color: var(--primary-color);
    }

    .sidebar-menu-count {
      font-size: 12px;
      color: #666;
      background: rgba(0, 0, 0, 0.05);
      padding: 2px 8px;
      border-radius: 10px;
    }

    /* Submenu */
    .sidebar-submenu {
      background: rgba(0, 0, 0, 0.02);
      border-left: 3px solid rgba(232, 196, 184, 0.3);
      display: none;
    }

    .sidebar-submenu.active {
      display: block;
    }

    .sidebar-sublink {
      display: block;
      padding: 10px 20px 10px 40px;
      text-decoration: none;
      color: #666;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .sidebar-sublink:hover {
      color: var(--primary-color);
      background: rgba(232, 196, 184, 0.05);
    }

    /* Sidebar Footer */
    .sidebar-footer {
      padding: 20px;
      border-top: 1px solid rgba(0, 0, 0, 0.08);
      margin-top: 20px;
    }

    .sidebar-account {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      text-decoration: none;
      color: var(--text-dark);
      border-radius: 8px;
      transition: all 0.3s ease;
      background: rgba(0, 0, 0, 0.02);
    }

    .sidebar-account:hover {
      background: rgba(232, 196, 184, 0.1);
      color: var(--primary-color);
    }

    /* ==================== */
    /* DESKTOP SPECIFIC (1025px and up) */
    /* ==================== */
    @media (min-width: 1025px) {
      /* On desktop, adjust sidebar to be like ChatGPT */
      .sidebar {
        width: 280px;
        left: -280px;
      }
      
      .sidebar.active {
        left: 0;
      }
      
      /* When sidebar is active on desktop, shift content */
      body.sidebar-open .header,
      body.sidebar-open main {
        margin-left: 280px;
        transition: margin-left 0.3s ease;
      }
      
      /* Mobile adjustments */
      @media (max-width: 768px) {
        .logo {
          position: absolute;
          left: 50%;
          transform: translateX(-50%);
        }
        
        .logo img {
          height: 35px;
        }
      }
    }

    /* Body lock when sidebar is open */
    body.sidebar-open {
      overflow: hidden;
    }
  </style>
</head>
<body>
  <!-- Main Header -->
  <header class="header" id="main-header">
    <div class="header-container">
      <div class="header-inner">
        <!-- Sidebar Toggle Button -->
        <button class="sidebar-toggle" id="sidebarToggle" aria-label="Open sidebar menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </button>

        <!-- Logo -->
        <div class="logo">
          <a href="{{ routes.root_url }}">
            <img 
              src="https://cdn.shopify.com/s/files/1/0567/4172/4316/files/logo.jpg?v=1764436849" 
              alt="{{ shop.name }}"
              width="120"
              height="40"
              loading="eager"
            >
          </a>
        </div>

        <!-- Header Actions -->
        <div class="header-actions">
          <a href="{{ routes.search_url }}" class="header-action search-btn" aria-label="Search">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
            </svg>
          </a>
          <a href="{{ routes.account_login_url }}" class="header-action account-btn" aria-label="Account">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
          </a>
          <a href="{{ routes.cart_url }}" class="header-action cart-btn" aria-label="Cart">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/>
            </svg>
            <span class="cart-count">{{ cart.item_count }}</span>
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar" id="mainSidebar">
    <div class="sidebar-header">
      <a href="{{ routes.root_url }}" class="sidebar-logo">
        <img 
          src="https://cdn.shopify.com/s/files/1/0567/4172/4316/files/logo.jpg?v=1764436849" 
          alt="{{ shop.name }}"
          width="140"
          height="35"
          loading="eager"
        >
      </a>
      <button class="sidebar-close" id="sidebarClose" aria-label="Close menu">
        &times;
      </button>
    </div>

    <div class="sidebar-content">
      <!-- Shop Section -->
      <div class="sidebar-section">
        <div class="sidebar-section-title">Shop</div>
        <ul class="sidebar-menu">
          <li class="sidebar-menu-item">
            <a href="{{ routes.all_products_collection_url }}" class="sidebar-menu-link">
              All Products
              <span class="sidebar-menu-count">{{ collections.all.products_count | default: 0 }}</span>
            </a>
          </li>

          <!-- Product Type Dropdown -->
          <li class="sidebar-menu-item">
            <button class="sidebar-menu-link" data-toggle="submenu" data-target="product-type">
              By Product Type
              <span class="sidebar-menu-count">6</span>
            </button>
            <div class="sidebar-submenu" id="product-type">
              {%- assign collections_to_show = 'shampoo,conditioner,curl-cream,hair-oil,styling,treatments' | split: ',' -%}
              {%- for handle in collections_to_show -%}
                {%- assign collection = collections[handle] -%}
                <a href="{{ collection.url | default: routes.collections_url }}" class="sidebar-sublink">
                  {%- if collection -%}
                    {{ collection.title }}
                  {%- else -%}
                    {{ handle | replace: '-', ' ' | capitalize }}
                  {%- endif -%}
                </a>
              {%- endfor -%}
            </div>
          </li>

          <!-- Curl Type Dropdown -->
          <li class="sidebar-menu-item">
            <button class="sidebar-menu-link" data-toggle="submenu" data-target="curl-type">
              By Curl Type
              <span class="sidebar-menu-count">6</span>
            </button>
            <div class="sidebar-submenu" id="curl-type">
              {%- assign curl_collections = 'wavy-hair,curly-hair,coily-hair,fine-hair,thick-hair,damaged-hair' | split: ',' -%}
              {%- for handle in curl_collections -%}
                {%- assign collection = collections[handle] -%}
                <a href="{{ collection.url | default: routes.collections_url }}" class="sidebar-sublink">
                  {%- if collection -%}
                    {{ collection.title }}
                  {%- else -%}
                    {{ handle | replace: '-', ' ' | capitalize }}
                  {%- endif -%}
                </a>
              {%- endfor -%}
            </div>
          </li>
        </ul>
      </div>

      <!-- Guides & Resources -->
      <div class="sidebar-section">
        <div class="sidebar-section-title">Guides & Resources</div>
        <ul class="sidebar-menu">
          <li class="sidebar-menu-item">
            <a href="#hair-quiz" class="sidebar-menu-link">Hair Quiz</a>
          </li>
          <li class="sidebar-menu-item">
            <a href="{{ blogs['guides'].url | default: '/blogs/guides' }}" class="sidebar-menu-link">
              Hair Care Guides
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a href="#services-by-concern" class="sidebar-menu-link">Services by Concern</a>
          </li>
          <li class="sidebar-menu-item">
            <a href="{{ pages['about'].url | default: '/pages/about' }}" class="sidebar-menu-link">Our Story</a>
          </li>
        </ul>
      </div>

      <!-- Information -->
      <div class="sidebar-section">
        <div class="sidebar-section-title">Information</div>
        <ul class="sidebar-menu">
          <li class="sidebar-menu-item">
            <a href="{{ routes.search_url }}" class="sidebar-menu-link">Search</a>
          </li>
          {%- for page in pages limit: 5 -%}
            {%- unless page.handle contains 'policy' -%}
              <li class="sidebar-menu-item">
                <a href="{{ page.url }}" class="sidebar-menu-link">{{ page.title }}</a>
              </li>
            {%- endunless -%}
          {%- endfor -%}
        </ul>
      </div>
    </div>

    <div class="sidebar-footer">
      {% if customer %}
        <a href="{{ routes.account_url }}" class="sidebar-account">
          <div style="width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color), #D4A59A); display: flex; align-items: center; justify-content: center; color: white;">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
          </div>
          <div>
            <span style="display: block; font-size: 14px; font-weight: 600;">{{ customer.name | truncate: 20 }}</span>
            <span style="display: block; font-size: 12px; color: #666;">{{ customer.email | truncate: 25 }}</span>
          </div>
        </a>
      {% else %}
        <a href="{{ routes.account_login_url }}" class="sidebar-account">
          <div style="width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color), #D4A59A); display: flex; align-items: center; justify-content: center; color: white;">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
          </div>
          <div>
            <span style="display: block; font-size: 14px; font-weight: 600;">Sign In</span>
            <span style="display: block; font-size: 12px; color: #666;">Access your account</span>
          </div>
        </a>
      {% endif %}

      <!-- Cart Summary -->
      <div style="margin-top: 16px; padding: 16px; background: rgba(232, 196, 184, 0.05); border-radius: 8px;">
        <a href="{{ routes.cart_url }}" style="display: flex; align-items: center; justify-content: space-between; text-decoration: none; color: var(--text-dark);">
          <span style="font-weight: 500;">View Cart</span>
          <span style="background: var(--primary-color); color: white; border-radius: 12px; padding: 4px 12px; font-size: 13px; font-weight: 600;">
            {{ cart.item_count }} item{% if cart.item_count != 1 %}s{% endif %}
          </span>
        </a>
      </div>
    </div>
  </aside>

  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    console.log('Header script loaded');
    
    const sidebar = document.getElementById('mainSidebar');
    const overlay = document.getElementById('sidebarOverlay');
    const toggleBtn = document.getElementById('sidebarToggle');
    const closeBtn = document.getElementById('sidebarClose');
    
    if (!sidebar || !toggleBtn) {
      console.error('Sidebar elements not found');
      return;
    }
    
    // Toggle sidebar
    function toggleSidebar() {
      console.log('Toggle sidebar');
      sidebar.classList.toggle('active');
      overlay.classList.toggle('active');
      document.body.classList.toggle('sidebar-open');
      
      // On desktop, shift content when sidebar is open
      if (window.innerWidth >= 1025 && sidebar.classList.contains('active')) {
        document.body.style.marginLeft = '280px';
      } else {
        document.body.style.marginLeft = '0';
      }
    }
    
    // Close sidebar
    function closeSidebar() {
      sidebar.classList.remove('active');
      overlay.classList.remove('active');
      document.body.classList.remove('sidebar-open');
      document.body.style.marginLeft = '0';
    }
    
    // Event listeners
    toggleBtn.addEventListener('click', toggleSidebar);
    
    if (closeBtn) {
      closeBtn.addEventListener('click', closeSidebar);
    }
    
    if (overlay) {
      overlay.addEventListener('click', closeSidebar);
    }
    
    // Escape key to close
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && sidebar.classList.contains('active')) {
        closeSidebar();
      }
    });
    
    // Handle submenu toggles
    const submenuToggles = document.querySelectorAll('[data-toggle="submenu"]');
    submenuToggles.forEach(toggle => {
      toggle.addEventListener('click', function() {
        const targetId = this.getAttribute('data-target');
        const submenu = document.getElementById(targetId);
        if (submenu) {
          submenu.classList.toggle('active');
        }
      });
    });
    
    // Mark active links
    function markActiveLinks() {
      const currentUrl = window.location.pathname;
      const links = document.querySelectorAll('.sidebar-menu-link, .sidebar-sublink');
      
      links.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href !== '#' && currentUrl.includes(href.replace(/^\//, '').split('?')[0])) {
          link.classList.add('active');
        }
      });
    }
    
    markActiveLinks();
    
    // Handle window resize
    window.addEventListener('resize', function() {
      if (window.innerWidth < 1025 && sidebar.classList.contains('active')) {
        closeSidebar();
      }
    });
    
    // Update cart count
    function updateCartCount() {
      const cartCounts = document.querySelectorAll('.cart-count');
      const itemCount = {{ cart.item_count | default: 0 }};
      
      cartCounts.forEach(span => {
        span.textContent = itemCount;
      });
    }
    
    updateCartCount();
    
    console.log('Sidebar initialized successfully');
  });
  </script>

  <main id="MainContent">
    {{ content_for_layout }}
  </main>
</body>
</html>