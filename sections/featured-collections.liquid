{% comment %} Featured Collections - Working Carousel with Auto-Rotating Images {% endcomment %}

<style>
/* Reset and Base */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* Section */
.featured-collections-section {
  padding: 60px 20px;
  background: #FAF8F6;
  position: relative;
}

.featured-collections-header {
  text-align: center;
  margin-bottom: 40px;
}

.featured-collections-title {
  font-size: clamp(2rem, 3vw, 2.8rem);
  font-weight: 700;
  color: #2d2d2d;
  margin-bottom: 12px;
}

.featured-collections-description {
  font-size: 1.1rem;
  color: #666;
  max-width: 700px;
  margin: 0 auto;
}

/* Carousel Container */
.featured-collections-carousel {
  max-width: 1400px;
  margin: 0 auto;
  position: relative;
  overflow: hidden;
}

.carousel-container {
  width: 100%;
  overflow: hidden;
  position: relative;
}

.carousel-track {
  display: flex;
  transition: transform 0.5s ease-in-out;
  gap: 30px;
  padding: 10px 0;
}

/* Card Styles */
.collection-card {
  min-width: 300px;
  background: white;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  transition: transform 0.3s ease;
  flex-shrink: 0;
}

.collection-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
}

/* Image Container - Auto Rotate */
.image-rotate-container {
  position: relative;
  width: 100%;
  height: 280px;
  background: #f5f5f5;
  overflow: hidden;
}

.rotating-image {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  opacity: 0;
  transition: opacity 0.8s ease-in-out;
}

.rotating-image.active {
  opacity: 1;
}

/* Content */
.card-content {
  padding: 20px;
}

.collection-title {
  font-size: 1.25rem;
  font-weight: 700;
  color: #222;
  margin-bottom: 8px;
}

.collection-count {
  font-size: 0.95rem;
  color: #777;
  margin-bottom: 20px;
}

.shop-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  padding: 12px;
  background: linear-gradient(135deg, #D4A574 0%, #B07F53 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-weight: 600;
  text-decoration: none;
  cursor: pointer;
  transition: all 0.3s ease;
}

.shop-button:hover {
  background: white;
  color: #D4A574;
  box-shadow: 0 0 0 2px #D4A574;
}

/* Navigation Buttons */
.carousel-nav {
  display: flex;
  justify-content: center;
  gap: 15px;
  margin-top: 30px;
}

.nav-button {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: white;
  border: 2px solid #eee;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  font-size: 20px;
  color: #333;
}

.nav-button:hover {
  background: #D4A574;
  color: white;
  border-color: #D4A574;
  transform: scale(1.1);
}

.nav-button:disabled {
  opacity: 0.3;
  cursor: not-allowed;
  transform: none;
}

.nav-button:disabled:hover {
  background: white;
  color: #333;
  border-color: #eee;
}

/* Responsive */
@media (max-width: 768px) {
  .featured-collections-section {
    padding: 40px 15px;
  }
  
  .collection-card {
    min-width: 280px;
  }
  
  .image-rotate-container {
    height: 240px;
  }
  
  .carousel-track {
    gap: 20px;
  }
}

@media (max-width: 480px) {
  .collection-card {
    min-width: 260px;
  }
  
  .image-rotate-container {
    height: 220px;
  }
  
  .carousel-nav {
    margin-top: 20px;
  }
  
  .nav-button {
    width: 44px;
    height: 44px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Carousel Elements
  const carouselTrack = document.getElementById('carouselTrack');
  const prevButton = document.getElementById('prevButton');
  const nextButton = document.getElementById('nextButton');
  const cards = document.querySelectorAll('.collection-card');
  
  if (!carouselTrack || cards.length === 0) return;
  
  // Carousel State
  let currentPosition = 0;
  const gap = 30;
  let cardWidth = cards[0].offsetWidth + gap;
  const container = carouselTrack.parentElement;
  
  // Ensure transition is set
  carouselTrack.style.transition = 'transform 0.5s ease-in-out';
  
  // Calculate max scroll
  function getMaxScroll() {
    const containerWidth = container.clientWidth;
    const trackWidth = carouselTrack.scrollWidth;
    return Math.max(0, trackWidth - containerWidth);
  }
  
  // Update carousel position
  function updateCarousel() {
    // Ensure we don't scroll past limits
    const maxScroll = getMaxScroll();
    currentPosition = Math.min(currentPosition, maxScroll);
    currentPosition = Math.max(currentPosition, 0);
    
    // Apply transform
    carouselTrack.style.transform = `translateX(-${currentPosition}px)`;
    
    // Update button states
    if (prevButton) {
      prevButton.disabled = currentPosition === 0;
    }
    if (nextButton) {
      nextButton.disabled = currentPosition >= maxScroll;
    }
  }
  
  // Next slide
  function nextSlide() {
    const containerWidth = container.clientWidth;
    currentPosition += containerWidth * 0.8; // Move 80% of container width
    updateCarousel();
  }
  
  // Previous slide
  function prevSlide() {
    const containerWidth = container.clientWidth;
    currentPosition -= containerWidth * 0.8; // Move 80% of container width
    updateCarousel();
  }
  
  // Button listeners
  if (nextButton) nextButton.addEventListener('click', nextSlide);
  if (prevButton) prevButton.addEventListener('click', prevSlide);
  
  // Initialize
  updateCarousel();
  
  // Handle resize
  window.addEventListener('resize', updateCarousel);
  
  // Your image rotation code here...
  function startImageRotation() {
    const imageContainers = document.querySelectorAll('.image-rotate-container');
    
    imageContainers.forEach(container => {
      const images = container.querySelectorAll('.rotating-image');
      if (images.length <= 1) return;
      
      let currentIndex = 0;
      
      // Show first image
      images.forEach((img, i) => {
        img.classList.toggle('active', i === 0);
      });
      
      const rotate = () => {
        images[currentIndex].classList.remove('active');
        currentIndex = (currentIndex + 1) % images.length;
        images[currentIndex].classList.add('active');
      };
      
      let interval = setInterval(rotate, 2000);
      
      container.addEventListener('mouseenter', () => clearInterval(interval));
      container.addEventListener('mouseleave', () => {
        interval = setInterval(rotate, 2000);
      });
    });
  }
  
  setTimeout(startImageRotation, 1000);
});
</script>

{% schema %}
{
  "name": "Featured Collections",
  "max_blocks": 10,
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Shop By Collection"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Discover curated products for your unique hair journey"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Select collection"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Featured Collections",
      "category": "Collections",
      "blocks": [
        {
          "type": "collection"
        },
        {
          "type": "collection"
        },
        {
          "type": "collection"
        },
        {
          "type": "collection"
        }
      ]
    }
  ]
}
{% endschema %}