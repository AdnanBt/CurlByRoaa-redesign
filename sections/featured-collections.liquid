{% comment %} Featured Collections - Horizontal Carousel {% endcomment %}

<style>
.featured-collections-section {
  padding: 60px 0;
  background: #FAF8F6;
  overflow: hidden;
}

.featured-collections-header {
  text-align: center;
  margin-bottom: 40px;
  padding: 0 20px;
}

.featured-collections-title {
  font-size: 2.2rem;
  font-weight: 700;
  margin-bottom: 12px;
  color: #2D2D2D;
}

.featured-collections-description {
  font-size: 1rem;
  color: #666;
  max-width: 600px;
  margin: 0 auto;
  line-height: 1.6;
}

.featured-collections-carousel-container {
  position: relative;
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 60px;
}

.featured-collections-carousel-wrapper {
  overflow-x: auto;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
  -ms-overflow-style: none;
  padding: 20px 10px;
  margin: -20px -10px;
}

.featured-collections-carousel-wrapper::-webkit-scrollbar {
  display: none;
}

.featured-collections-carousel {
  display: flex;
  gap: 25px;
  width: max-content;
  padding: 10px 0;
}

.featured-collection-card {
  flex: 0 0 280px;
  width: 280px;
  height: 350px;
  position: relative;
  border-radius: 12px;
  overflow: hidden;
  background: white;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  transition: all 0.3s ease;
}

.featured-collection-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.12);
}

.featured-collection-image-container {
  width: 100%;
  height: 200px;
  overflow: hidden;
}

.featured-collection-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.6s ease;
}

.featured-collection-card:hover .featured-collection-image {
  transform: scale(1.05);
}

.featured-collection-content {
  padding: 20px;
  background: white;
  height: 150px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.featured-collection-title {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 8px;
  color: #2D2D2D;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.featured-collection-product-count {
  font-size: 0.85rem;
  color: #666;
  margin-bottom: 15px;
}

.featured-collection-link {
  display: inline-block;
  padding: 8px 16px;
  background: #D4A574;
  color: white;
  text-decoration: none;
  border-radius: 6px;
  font-weight: 600;
  font-size: 0.85rem;
  transition: all 0.3s ease;
  text-align: center;
  border: 2px solid #D4A574;
}

.featured-collection-link:hover {
  background: transparent;
  color: #D4A574;
}

.featured-collection-placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: #f1f3f5;
  color: #666;
  text-align: center;
  padding: 20px;
}

.featured-placeholder-icon {
  font-size: 2rem;
  margin-bottom: 10px;
  opacity: 0.7;
}

.featured-placeholder-text {
  font-size: 0.9rem;
  font-weight: 500;
}

.featured-collections-nav-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: white;
  border: none;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  z-index: 20;
  opacity: 0.8;
  transition: all 0.3s ease;
}

.featured-collections-nav-btn:hover {
  transform: translateY(-50%) scale(1.1);
  box-shadow: 0 6px 20px rgba(0,0,0,0.2);
}

.featured-collections-nav-btn.prev { left: 10px; }
.featured-collections-nav-btn.next { right: 10px; }
.featured-collections-nav-btn:disabled { opacity: 0.3; cursor: not-allowed; }

.featured-collections-dots {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin-top: 30px;
}

.featured-collections-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: rgba(0,0,0,0.2);
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
}

.featured-collections-dot.active {
  background: #D4A574;
  transform: scale(1.3);
}

/* Responsive */
@media (max-width:1024px){.featured-collection-card{flex:0 0 240px;height:320px}.featured-collection-image-container{height:180px}.featured-collection-content{height:140px;padding:16px}}
@media (max-width:768px){.featured-collections-section{padding:40px 0}.featured-collections-title{font-size:1.8rem}.featured-collections-carousel-container{padding:0 20px}.featured-collection-card{flex:0 0 200px;height:300px}.featured-collection-image-container{height:160px}.featured-collection-content{height:140px;padding:12px}.featured-collections-nav-btn{display:none}}
@media (max-width:480px){.featured-collections-title{font-size:1.6rem}.featured-collection-card{flex:0 0 180px;height:280px}.featured-collection-image-container{height:140px}.featured-collection-content{height:140px;padding:10px}.featured-collection-link{padding:6px 12px;font-size:.8rem}.featured-collections-dots{margin-top:20px}}
</style>

<section class="featured-collections-section">
  <div class="featured-collections-header">
    <h2 class="featured-collections-title">{{ section.settings.title | default: 'Shop By Collection' }}</h2>
    <p class="featured-collections-description">{{ section.settings.description | default: 'Find the perfect products for your unique curl pattern' }}</p>
  </div>

  <div class="featured-collections-carousel-container">
    <button class="featured-collections-nav-btn prev" id="featured-collections-prev" aria-label="Previous">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
    </button>

    <div class="featured-collections-carousel-wrapper">
      <div class="featured-collections-carousel" id="featured-collections-carousel">
        {% if section.blocks.size > 0 %}
          {% for block in section.blocks %}
            {% assign collection = collections[block.settings.collection] %}
            {% if collection %}
              <div class="featured-collection-card">
                <div class="featured-collection-image-container">
                  {% if collection.image %}
                    <img src="{{ collection.image | image_url: width:400, height:300, crop:'center' }}" alt="{{ collection.title }}" class="featured-collection-image" loading="lazy">
                  {% elsif collection.products_count > 0 and collection.products.first.featured_image %}
                    <img src="{{ collection.products.first.featured_image | image_url: width:400, height:300, crop:'center' }}" alt="{{ collection.title }}" class="featured-collection-image" loading="lazy">
                  {% else %}
                    <div class="featured-collection-placeholder"><div class="featured-placeholder-icon">ðŸ“¦</div><div class="featured-placeholder-text">{{ collection.title }}</div></div>
                  {% endif %}
                </div>
                <div class="featured-collection-content">
                  <h3 class="featured-collection-title">{{ collection.title }}</h3>
                  <span class="featured-collection-product-count">{{ collection.products_count }} {{ collection.products_count | pluralize: 'product', 'products' }}</span>
                  <a href="{{ collection.url }}" class="featured-collection-link">Shop Now</a>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        {% endif %}
      </div>
    </div>

    <button class="featured-collections-nav-btn next" id="featured-collections-next" aria-label="Next">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
    </button>

    <div class="featured-collections-dots" id="featured-collections-dots"></div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const wrapper = document.querySelector('.featured-collections-carousel-wrapper');
  const carousel = document.getElementById('featured-collections-carousel');
  const prevBtn = document.getElementById('featured-collections-prev');
  const nextBtn = document.getElementById('featured-collections-next');
  const dotsContainer = document.getElementById('featured-collections-dots');
  const cards = document.querySelectorAll('.featured-collection-card');
  if(!carousel || !wrapper) return;

  let currentIndex = 0;
  const cardWidth = cards[0].offsetWidth;
  const gap = 25;
  const totalCards = cards.length;

  function updateButtons() {
    prevBtn.disabled = currentIndex === 0;
    nextBtn.disabled = currentIndex >= totalCards - 1;
  }

  function scrollToIndex() {
    wrapper.scrollTo({ left: currentIndex*(cardWidth+gap), behavior:'smooth' });
    updateButtons();
  }

  prevBtn.addEventListener('click', ()=>{ if(currentIndex>0){ currentIndex--; scrollToIndex(); }});
  nextBtn.addEventListener('click', ()=>{ if(currentIndex<totalCards-1){ currentIndex++; scrollToIndex(); }});

  // Swipe support
  let startX=0;
  wrapper.addEventListener('touchstart', e=>{ startX = e.touches[0].clientX; });
  wrapper.addEventListener('touchend', e=>{
    const endX = e.changedTouches[0].clientX;
    if(startX-endX>50) nextBtn.click();
    else if(endX-startX>50) prevBtn.click();
  });

  updateButtons();
});
</script>

{% schema %}
{
  "name": "Featured Collections",
  "max_blocks": 8,
  "settings": [
    { "type": "text", "id": "title", "label": "Section Title", "default": "Shop By Collection" },
    { "type": "textarea", "id": "description", "label": "Description", "default": "Find the perfect products for your unique curl pattern" }
  ],
  "blocks": [
    { "type": "collection", "name": "Collection", "settings":[ { "type":"collection","id":"collection","label":"Select Collection"} ] }
  ],
  "presets": [
    { "name": "Featured Collections", "category": "Collections" }
  ]
}
{% endschema %}
