{%- comment -%}
ChatGPT-style responsive sidebar snippet
Usage: include this in theme.liquid or header.liquid:
{% include 'chatgpt-sidebar' %}
{%- endcomment -%}

<!-- ChatGPT Sidebar -->
<aside id="chatgptSidebar" class="chatgpt-sidebar" aria-hidden="true" role="dialog" aria-label="Site navigation">
  <div class="chatgpt-sidebar__inner">
    <div class="chatgpt-sidebar__header">
      <a href="{{ routes.root_url }}" class="chatgpt-sidebar__logo" aria-label="{{ shop.name }}">
        <img src="{{ 'logo.jpg' | asset_url }}" alt="{{ shop.name }}" width="120" height="40" loading="eager">
      </a>
      <button id="chatgptSidebarClose" class="chatgpt-sidebar__close" aria-label="Close menu">&times;</button>
    </div>

    <nav class="chatgpt-sidebar__nav" aria-label="Main">
      {%- comment -%}
        Prefer linklists (menus) if set up in Shopify: use "main-menu" or fallback to curated links.
      {%- endcomment -%}
      {%- assign main_menu = linklists.main-menu.links | default: '' -%}
      {%- if main_menu.size > 0 -%}
        <ul class="chatgpt-menu">
          {%- for item in linklists.main-menu.links -%}
            <li class="chatgpt-menu__item">
              <a href="{{ item.url }}" class="chatgpt-menu__link">{{ item.title }}</a>
            </li>
          {%- endfor -%}
        </ul>
      {%- else -%}
        <!-- fallback curated links (keeps parity with your previous nav) -->
        <ul class="chatgpt-menu">
          <li class="chatgpt-menu__item"><a href="{{ routes.all_products_collection_url }}" class="chatgpt-menu__link">Shop</a></li>
          <li class="chatgpt-menu__item"><a href="#hair-quiz" class="chatgpt-menu__link">Hair Quiz</a></li>
          <li class="chatgpt-menu__item"><a href="#services-by-concern" class="chatgpt-menu__link">Services by Concern</a></li>
          <li class="chatgpt-menu__item"><a href="{{ pages['about'].url | default: '/pages/about' }}" class="chatgpt-menu__link">Our Story</a></li>
          <li class="chatgpt-menu__item"><a href="{{ blogs['guides'].url | default: '/blogs/guides' }}" class="chatgpt-menu__link">Guides</a></li>
        </ul>
      {%- endif -%}
    </nav>

    <div class="chatgpt-sidebar__sections">
      <!-- Quick sections like shop-by-type and curl types (mirrors your old dropdown groups) -->
      <div class="chatgpt-section">
        <div class="chatgpt-section__title">By Product Type</div>
        <ul class="chatgpt-links">
          {%- assign ct = 'shampoo,conditioner,curl-cream,hair-oil,styling,treatments' | split: ',' -%}
          {%- for handle in ct -%}
            {%- assign c = collections[handle] -%}
            <li><a href="{{ c.url | default: routes.collections_url }}" class="chatgpt-links__link">{{ c.title | default: handle | replace: '-', ' ' | capitalize }}</a></li>
          {%- endfor -%}
        </ul>
      </div>

      <div class="chatgpt-section">
        <div class="chatgpt-section__title">By Curl Type</div>
        <ul class="chatgpt-links">
          {%- assign ct2 = 'wavy-hair,curly-hair,coily-hair,fine-hair,thick-hair,damaged-hair' | split: ',' -%}
          {%- for handle in ct2 -%}
            {%- assign c = collections[handle] -%}
            <li><a href="{{ c.url | default: routes.collections_url }}" class="chatgpt-links__link">{{ c.title | default: handle | replace: '-', ' ' | capitalize }}</a></li>
          {%- endfor -%}
        </ul>
      </div>
    </div>

    <div class="chatgpt-sidebar__footer">
      <a href="{{ routes.account_login_url }}" class="chatgpt-sidebar__cta">Account</a>
      <a href="{{ routes.cart_url }}" class="chatgpt-sidebar__cta chatgpt-sidebar__cta--muted">Cart ({{ cart.item_count }})</a>
    </div>
  </div>
</aside>

<!-- Overlay for mobile -->
<div id="chatgptSidebarOverlay" class="chatgpt-sidebar-overlay" aria-hidden="true"></div>
<script defer>
document.addEventListener("DOMContentLoaded", () => {
  const sidebar = document.getElementById("sidebarPanel");
  const openBtn = document.getElementById("sidebarToggle");
  const closeBtn = document.getElementById("sidebarClose");

  openBtn.addEventListener("click", () => {
    sidebar.classList.remove("-translate-x-full");
  });

  closeBtn.addEventListener("click", () => {
    sidebar.classList.add("-translate-x-full");
  });

  // Mobile dropdowns inside sidebar
  document.querySelectorAll("[data-sidebar-dropdown]").forEach(btn => {
    btn.addEventListener("click", () => {
      const submenu = btn.nextElementSibling;
      submenu.classList.toggle("hidden");
    });
  });
});
</script>
